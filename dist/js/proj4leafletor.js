!function(o){var i,n;if("function"==typeof define&&define.amd)define(["leaflet","proj4"],o);else if("undefined"!=typeof module)i=require("leaflet"),n=require("proj4"),module.exports=o(i,n);else{if("undefined"==typeof window.L||"undefined"==typeof window.proj4)throw"Leaflet and proj4 must be loaded first";o(window.L,window.proj4)}}(function(o,i){return o.Proj={},o.Proj._isProj4Obj=function(o){return"undefined"!=typeof o.inverse&&"undefined"!=typeof o.forward},o.Proj.Projection=o.Class.extend({initialize:function(i,n,t){var e=o.Proj._isProj4Obj(i);this._proj=e?i:this._projFromCodeDef(i,n),this.bounds=e?n:t},project:function(i){var n=this._proj.forward([i.lng,i.lat]);return new o.Point(n[0],n[1])},unproject:function(i,n){var t=this._proj.inverse([i.x,i.y]);return new o.LatLng(t[1],t[0],n)},_projFromCodeDef:function(o,n){if(n)i.defs(o,n);else if(void 0===i.defs[o]){var t=o.split(":");if(t.length>3&&(o=t[t.length-3]+":"+t[t.length-1]),void 0===i.defs[o])throw"No projection definition for code "+o}return i(o)}}),o.Proj.CRS=o.Class.extend({includes:o.CRS,options:{transformation:new o.Transformation(1,0,(-1),0)},initialize:function(i,n,t){var e,s,r,f;if(o.Proj._isProj4Obj(i)?(s=i,e=s.srsCode,f=n||{},this.projection=new o.Proj.Projection(s,f.bounds)):(e=i,r=n,f=t||{},this.projection=new o.Proj.Projection(e,r,f.bounds)),o.Util.setOptions(this,f),this.code=e,this.transformation=this.options.transformation,this.options.origin&&(this.transformation=new o.Transformation(1,(-this.options.origin[0]),(-1),this.options.origin[1])),this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions){this._scales=[];for(var a=this.options.resolutions.length-1;a>=0;a--)this.options.resolutions[a]&&(this._scales[a]=1/this.options.resolutions[a])}this.infinite=!this.options.bounds},scale:function(o){var i,n,t,e,s=Math.floor(o);return o===s?this._scales[o]:(i=this._scales[s],n=this._scales[s+1],t=n-i,e=o-s,i+t*e)},zoom:function(o){var i,n,t=this._closestElement(this._scales,o),e=this._scales.indexOf(t);return o===t?e:(i=e+1,n=this._scales[i]-t,(o-t)/n+e)},_closestElement:function(o,i){for(var n,t=o.length;t--;)o[t]<=i&&(void 0===n||n<o[t])&&(n=o[t]);return n}}),o.Proj.GeoJSON=o.GeoJSON.extend({initialize:function(i,n){if(i.crs&&"name"===i.crs.type){var t=new o.Proj.CRS(i.crs.properties.name);n=n||{},n.coordsToLatLng=function(i){var n=o.point(i[0],i[1]);return t.projection.unproject(n)}}o.GeoJSON.prototype.initialize.call(this,i,n)}}),o.Proj.geoJson=function(i,n){return new o.Proj.GeoJSON(i,n)},o.Proj});