function aide(){"use strict";$(this).hasClass("btn btn-info")?($(this).removeClass("btn-info").addClass("btn btn-success"),$("#btn-aide-txt",this).text("Cacher"),$("#infoaide").show()):($(this).removeClass("btn-success").addClass("btn-info"),$("#btn-aide-txt",this).text("Aide"),$("#infoaide").hide())}function inserauteur(t,e,i,a){"use strict";$.ajax({url:"modeles/ajax/biblio/inserauteur.php",type:"POST",dataType:"json",data:{nom:t,prenom:e,ab:i,dble:a},success:function(i){if("Oui"==i.statut)if(i.doublon)endoublon(t,e);else{var a=$("#auteur").val(),l=$("#idauteur").val();l?$("#idauteur").val(l+", "+i.idauteur):$("#idauteur").val(i.idauteur),$("#auteur").val(a+i.nom+" "+i.prenom+", ")}else alert(i.statut)},error:function(t){alert("Une erreure est survenue")}})}function endoublon(t,e,i){"use strict";$("#doublon").val(t+" "+e),$("#dia2").modal("show")}function CKupdate(){for(instance in CKEDITOR.instances)CKEDITOR.instances[instance].updateElement()}function traitementid(){"use strict";var t=[],e=[],i=[];$("#ltaxon > li[id]").each(function(){t.push($(this).attr("id"))}),$("#cdnom").val(t),$("#lmotcle > li[id]").each(function(){e.push($(this).attr("id"))}),$("#mc").val(e),$("#lcommune > li[id]").each(function(){i.push($(this).attr("id"))}),$("#codecom").val(i)}function rbiblio(t){$("#lcommune").html(""),$("#ltaxon").html(""),$("#lmotcle").html(""),$.ajax({url:"modeles/ajax/biblio/bibliorecherche.php",type:"POST",dataType:"json",data:{id:t},success:function(t){"Oui"==t.statut&&($("#gestionb").prop("disabled",!1),$("#BttV").hide(),$("#BttM").show(),$("#BttN").show(),CKEDITOR.instances.titre.setData(t.biblio.titre),CKEDITOR.instances.resum.setData(t.biblio.resume),$("#publication").val(t.biblio.publi),$("#annee").val(t.biblio.annee),$("#tome").val(t.biblio.tome),$("#fas").val(t.biblio.fascicule),$("#page").val(t.biblio.page),$("#type").val(t.biblio.typep),$("#lienw").val(t.biblio.url),$("#isbn").val(t.biblio.isbn),$("#idauteur").val(t.idauteur),$("#auteur").val(t.auteur),t.biblio.observa?$("#observa").val(t.biblio.observa):$("#observa").val("NR"),t.commune?($("#lcommune").prepend(t.commune),$("#codecom").val(t.codecom)):($("#lcommune").html(""),$("#codecom").val("")),t.taxon?($("#ltaxon").prepend(t.taxon),$("#cdnom").val(t.cdnom)):($("#ltaxon").html(""),$("#cdnom").val("")),t.motcle?($("#lmotcle").prepend(t.motcle),$("#mc").val(t.idmc)):($("#lmotcle").html(""),$("#mc").val("")))}})}$(document).ready(function(){"use strict";$("#aide").on("click",aide),$("#infoaide").hide(),$("#valajax").hide(),$("#BttV").hide(),$("#BttM").hide(),$("#BttP").hide(),$("#BttA").hide(),$("#gestionb").prop("disabled",!0),CKEDITOR.config.entities=!1,CKEDITOR.config.entities_latin=!1,CKEDITOR.inline("resum",{toolbar:[["Cut","Copy","Paste","-","Undo","Redo"],{name:"basicstyles",items:["Bold","Italic"]}],uiColor:"#FFCC99"}),CKEDITOR.inline("titre",{toolbar:[["Cut","Copy","Paste","-","Undo","Redo"],{name:"basicstyles",items:["Bold","Italic"]}],uiColor:"#FFCC99"});var t=$("#idbiblio").val();"0"!=t&&rbiblio(t)}),$(function(){$("#BttN").click(function(){$("#gestionb").prop("disabled",!1),$("#biblio :input").not(":button, :submit, :reset").val(""),$("#type").val("NR"),$("#observa").val("NR"),CKEDITOR.instances.titre.setData(""),CKEDITOR.instances.resum.setData(""),$("#lcommune").html(""),$("#ltaxon").html(""),$("#lmotcle").html(""),$("#rauteur").val(""),$("#ridbiblio").val(""),$("#BttN").hide(),$("#BttM").hide(),$("#BttV").show(),$("#idbiblio").val(0),$("#auteur").focus()})}),$("#com").autocomplete({source:function(t,e){$.getJSON("modeles/ajax/biblio/listecommune.php",{term:t.term},function(t){e($.map(t,function(t){return{label:t.commune,value:t}}))})},select:function(t,e){return $("#com").val(""),$("#lcommune").prepend('<li id="'+e.item.value.codecom+'"><i class="fa fa-trash curseurlien text-danger"></i> '+e.item.value.commune+"</li>"),!1}}),$("#lcommune").on("click",".fa-trash",function(){"use strict";var t=$(this).parent().attr("id");$("#"+t).remove()}),$("#taxon").autocomplete({source:function(t,e){$.getJSON("modeles/ajax/taxon/liste.php",{term:t.term},function(t){e($.map(t,function(t){return""==t.nomvern?{label:t.nom,value:t}:{label:t.nom+" ("+t.nomvern+")",value:t}}))})},select:function(t,e){$("#taxon").val("");var i=e.item.value.cdnom;return $("#ltaxon").prepend('<li id="'+i+'"><i class="fa fa-trash curseurlien text-danger"></i> <i>'+e.item.value.nom+"</i> "+e.item.value.nomvern+"</li>"),!1}}),$("#ltaxon").on("click",".fa-trash",function(){"use strict";var t=$(this).parent().attr("id");$("#"+t).remove()}),$("#bttplusMc").click(function(){"use strict";$("#mca").val(""),$("#dia4").modal("show"),$("#mca").focus()}),$("#bttdia4").click(function(){"use strict";$("#dia4").modal("hide");var t=$("#mca").val();$.ajax({url:"modeles/ajax/biblio/insermot.php",type:"POST",dataType:"json",data:{mot:t},success:function(t){"Oui"==t.statut?$("#lmotcle").prepend('<li id="'+t.idmc+'"><i class="fa fa-trash curseurlien text-danger"></i> '+t.mot+"</li>"):alert(t.statut)},error:function(t){alert("Une erreure est survenue")}})}),$("#motcle").autocomplete({source:function(t,e){$.getJSON("modeles/ajax/biblio/listemotscles.php",{term:t.term},function(t){e($.map(t,function(t){return{label:t.mot,value:t}}))})},select:function(t,e){return $("#motcle").val(""),$("#lmotcle").prepend('<li id="'+e.item.value.idmc+'"><i class="fa fa-trash curseurlien text-danger"></i> '+e.item.value.mot+"</li>"),!1}}),$("#lmotcle").on("click",".fa-trash",function(){"use strict";var t=$(this).parent().attr("id");$("#"+t).remove()}),$("#bttplus").click(function(){"use strict";$("#nom").val(""),$("#prenom").val(""),$("#ab").val(""),$("#dia1").modal("show"),$("#nom").focus()}),$("#bttdia1").click(function(){"use strict";$("#dia1").modal("hide");var t=$("#nom").val(),e=$("#prenom").val(),i=$("#ab").val(),a="non";inserauteur(t,e,i,a)}),$("#bttdia2").click(function(){"use strict";var t=$("#nom").val().toUpperCase(),e=$("#prenom").val(),i=$("#ab").val(),a="oui";inserauteur(t,e,i,a)}),$(function(){"use strict";function t(t){return e(t).pop()}function e(t){return t.split(/,\s*/)}$("#auteur").autocomplete({source:function(e,i){$.getJSON("modeles/ajax/biblio/listeauteur.php",{term:t(e.term)},function(t){i($.map(t,function(t){return{label:t.nom+" "+t.prenom,value:t.idauteur}}))})},search:function(){var e=t(this.value);if(e.length<1)return!1},focus:function(){return!1},select:function(t,i){var a=e(this.value);a.pop(),a.push(i.item.label),a.push(""),this.value=a.join(", ");var l=$("#idauteur").val();return l?$("#idauteur").val(l+", "+i.item.value):$("#idauteur").val(i.item.value),!1},change:function(t,e){e.item||($(this).val(""),$("#idauteur").val(""),$("#dia3").modal("show"))}})}),$("#biblio").on("submit",function(t){"use strict";$("#valajax").show(),$("#mes").html(""),t.preventDefault(),traitementid(),CKupdate();var e=$(this),i=new FormData(e[0]),a=i;$.ajax({url:"modeles/ajax/biblio/inserbiblio.php",type:"POST",dataType:"json",data:a,contentType:!1,processData:!1,success:function(t){"Oui"==t.statut&&($("#BttP").show(),$("#BttA").show(),$("#BttN").show()),$("#valajax").hide(),$("#mes").html(t.mes)}})}),$("#ridbiblio").autocomplete({source:function(t,e){$.getJSON("modeles/ajax/biblio/biblioidbiblio.php",{term:t.term},function(t){e($.map(t,function(t){return{label:t.titre,value:t}}))})},select:function(t,e){return $("#ridbiblio").val(e.item.value.id),$("#idbiblio").val(e.item.value.id),rbiblio(e.item.value.id),!1}}),$("#rauteur").autocomplete({source:function(t,e){$.getJSON("modeles/ajax/biblio/biblioauteur.php",{term:t.term},function(t){e($.map(t,function(t){return{label:t.auteur+".,"+t.annee+" - "+t.titre,value:t}}))})},select:function(t,e){return $("#rauteur").val(e.item.value.auteur),$("#idbiblio").val(e.item.value.id),rbiblio(e.item.value.id),!1}}),$("#BttP").click(function(){"use strict";$("#BttV").show(),$("#BttM").hide(),$("#BttP").hide(),$("#BttA").hide(),$("#mes").html(""),$("#biblio :input").not(":button, :submit, :reset, #publication, #annee, #tome, #fas, #type ,#observa").val(""),CKEDITOR.instances.titre.setData(""),CKEDITOR.instances.resum.setData(""),$("#idbiblio").val(0),$("#lcommune").html(""),$("#ltaxon").html(""),$("#lmotcle").html(""),$("#rauteur").val(""),$("#ridbiblio").val("")}),$("#BttA").click(function(){"use strict";$("#BttV").show(),$("#BttM").hide(),$("#BttP").hide(),$("#BttA").hide(),$("#mes").html(""),$("#biblio :input").not(":button, :submit, :reset, #auteur, #idauteur, #observa").val(""),CKEDITOR.instances.titre.setData(""),CKEDITOR.instances.resum.setData(""),$("#idbiblio").val(0),$("#lcommune").html(""),$("#ltaxon").html(""),$("#lmotcle").html(""),$("#rauteur").val(""),$("#ridbiblio").val("")});