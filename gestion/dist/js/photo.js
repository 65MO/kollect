function liste(t,e,a){"use strict";$("#liste").show(),$.ajax({url:"modeles/ajax/photo/listephoto.php",type:"POST",dataType:"json",data:{cdnom:e,observa:a},success:function(e){if("Oui"==e.statut)if(e.nb>=1){$("#titresp").html(t+" - "+e.nb+'<small class="ml-2 text-muted">'+e.fiche+"</small>"),$("#tblliste").html(e.tbl),$("#afphoto").html(e.photo);var a;$.each(e.stade,function(t,e){a+="<option value="+e+">"+t+"</option>"}),$("#cstade").html(a)}else $("#titresp").html(t),$("#tblliste").html("<p>Aucune photo pour cette espèce.</p>"),$("#afphoto").html("");else alert("Pbroblème dans la requête")}})}function listeordre(t){"use strict";$("#liste").show(),$.ajax({url:"modeles/ajax/photo/listephoto.php",type:"POST",dataType:"json",data:{cdnom:t},success:function(t){"Oui"==t.statut?t.nb>=1?($("#tblliste").html(t.tbl),$("#afphoto").html(t.photo)):($("#tblliste").html("<p>Aucune photo pour cette espèce.</p>"),$("#afphoto").html("")):alert("Problème dans la requête")}})}function listeordremod(t){"use strict";$.ajax({url:"modeles/ajax/photo/listephoto.php",type:"POST",dataType:"json",data:{cdnom:t},success:function(t){"Oui"==t.statut?t.nb>=1?$("#tblliste").html(t.tbl):($("#tblliste").html("<p>Aucune photo pour cette espèce.</p>"),$("#afphoto").html("")):alert("Problème dans la requête")}})}function modordre(t,e){var a=$("#cdnom").val(),o=$("#ini").val();$.ajax({url:"modeles/ajax/photo/ordre.php",type:"POST",dataType:"json",data:{cdnom:a,ordre:t,idphoto:e,ini:o},success:function(t){$("#ini").val(""),"Oui"==t.statut?listeordre(a):alert("Problème dans la requête")}})}$(document).ready(function(){"use strict";$("#infoaide").hide(),$("#liste").hide(),$("#rtax").focus();var t=$("#get").val();if("oui"==t){var e=$("#cdnom").val(),a=$("#nom").val(),o=$("#observa").val();liste(a,e,o)}}),$(".pop").magnificPopup({delegate:".agrand",type:"image",tLoading:"Chargement image #%curr%...",mainClass:"mfp-img-mobile",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">Cette image #%curr%</a> est absente..',titleSrc:function(t){return t.el.attr("title")}}}),$("#aide").click(function(){"use strict";$(this).hasClass("btn-info")?($(this).removeClass("btn-info").addClass("btn-success"),$("#btn-aide-txt",this).text("Cacher"),$("#infoaide").show()):($(this).removeClass("btn-success").addClass("btn-info"),$("#btn-aide-txt",this).text("Aide"),$("#infoaide").hide())}),$("#rtax").autocomplete({source:function(t,e){$.getJSON("modeles/ajax/liste.php",{term:t.term},function(t){e($.map(t,function(t){return""==t.nomvern?{label:t.nom,value:t}:{label:t.nom+" ("+t.nomvern+")",value:t}}))})},select:function(t,e){return $("#rtax").val(""),$("#cdnom").val(e.item.value.cdnom),liste(e.item.label,e.item.value.cdnom,e.item.value.observatoire),!1}}),$("#tblliste").on("click",".ordre",function(){"use strict";var t=$("#ini").val();""==t&&$("#ini").val($(this).val())}),$("#tblliste").on("change",".ordre",function(){"use strict";var t=$(this).val(),e=$(this).parent().parent().attr("id");modordre(t,e)}),$("#tblliste").on("click",".modphoto",function(){"use strict";var t=$(this).parent().parent().attr("id");$("#idphoto").val(t);var e=$("#"+t+" .sexe").text(),a=$("#"+t+" .observa").text(),o=$("#"+t+" .stade").text(),s=$("#"+t+" .idobser").text();$("#mstade").val(o),$("#msexe").val(e),$("#auteur").val(s),$("#cobserva").val(a),$("#mobserva").val($("#cobserva option:selected").text());var l=$("#"+t+" .idobser").attr("id"),i=l.split("-");$("#idobser").val(i[1]),$("#dia1").modal("show")}),$("#cstade").change(function(){"use strict";$("#mstade").val($("#cstade option:selected").text())}),$("#cobserva").change(function(){"use strict";$("#mobserva").val($("#cobserva option:selected").text())}),$(function(){$("#auteur").autocomplete({source:function(t,e){$.getJSON("modeles/ajax/listeobservateur.php",{term:t.term},function(t){e($.map(t,function(t){return{label:t.observateur,value:t.idobser}}))})},select:function(t,e){return this.value=e.item.label,$("#idobser").val(e.item.value),!1}})}),$("#bttdia1").click(function(){"use strict";var t=$("#idphoto").val(),e=$("#idobser").val(),a=$("#msexe").val(),o=$("#cstade").val(),s=$("#cobserva").val();$.ajax({url:"modeles/ajax/photo/valimod.php",type:"POST",dataType:"json",data:{idphoto:t,auteur:e,sexe:a,stade:o,observa:s},success:function(t){if("Oui"==t.statut){var e=$("#cdnom").val();listeordremod(e)}else alert("Problème dans la requête")}})});